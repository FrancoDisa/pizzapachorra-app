import{u as re,a as ie,r as c,j as e}from"./index-IPWKeb15.js";function de({isOpen:C,onClose:F,onConfirm:K,pizza:n,editingItem:l,initialQuantity:V=1}){var X,Z,Q,O;const m=re(),d=ie(),[j,k]=c.useState(1),[r,S]=c.useState(!1),[v,R]=c.useState(n.id),[N,B]=c.useState(n.id),[W,P]=c.useState(""),[o,f]=c.useState("entera"),[g,L]=c.useState([]),[h,T]=c.useState([]),[_,D]=c.useState([]),[y,U]=c.useState([]),[w,Y]=c.useState([]),[M,G]=c.useState([]),[E,q]=c.useState([]),[A,H]=c.useState([]);c.useEffect(()=>{!C||!n||(l?(k(l.cantidad),S(l.es_mitad_y_mitad),R(l.pizza_mitad_1||n.id),B(l.pizza_mitad_2||n.id),L(l.extras_agregados||[]),T(l.extras_removidos||[]),D(l.mitad1_extras_agregados||[]),U(l.mitad1_extras_removidos||[]),Y(l.mitad2_extras_agregados||[]),G(l.mitad2_extras_removidos||[]),q(l.ambas_mitades_extras_agregados||[]),H(l.ambas_mitades_extras_removidos||[]),P(l.notas||""),f(l.es_mitad_y_mitad?"mitad1":"entera")):(k(V),S(!1),R(n.id),B(n.id),L([]),T([]),D([]),U([]),Y([]),G([]),q([]),H([]),P(""),f("entera")))},[l,n==null?void 0:n.id,C,V]),c.useEffect(()=>{r&&o==="entera"?f("mitad1"):!r&&(o==="mitad1"||o==="mitad2"||o==="ambas")&&f("entera")},[r,o]);const J=()=>{if(!n)return 0;let s=0,t=0,a=0;if(r){const i=m.find(x=>x.id===v),u=m.find(x=>x.id===N);i&&u&&(s=(parseFloat(i.precio_base)+parseFloat(u.precio_base))/2),_.forEach(x=>{const p=d.find($=>$.id===x);p&&(t+=parseFloat(p.precio))}),w.forEach(x=>{const p=d.find($=>$.id===x);p&&(t+=parseFloat(p.precio))}),E.forEach(x=>{const p=d.find($=>$.id===x);p&&(t+=parseFloat(p.precio))}),a=(y.length+M.length+A.length)*50}else s=parseFloat(n.precio_base),g.forEach(i=>{const u=d.find(b=>b.id===i);u&&(t+=parseFloat(u.precio))}),a=h.length*50;return Math.max(0,s+t-a)},z=()=>{const s=J();!r&&(g.length>0||h.length>0)&&console.log("🐛 DEBUG - Extras para pizza entera:",{extrasAgregados:g,extrasRemovidos:h,extras_agregados_data:g.map(a=>d.find(i=>i.id===a)).filter(Boolean),extras_removidos_data:h.map(a=>d.find(i=>i.id===a)).filter(Boolean)});const t={id:(l==null?void 0:l.id)||`temp_${Date.now()}`,pizza_id:r?0:n.id,cantidad:j,precio_unitario:s,es_mitad_y_mitad:r,pizza_mitad_1:r?v:0,pizza_mitad_2:r?N:0,extras_agregados:r?[]:g,extras_removidos:r?[]:h,mitad1_extras_agregados:r?_:void 0,mitad1_extras_removidos:r?y:void 0,mitad2_extras_agregados:r?w:void 0,mitad2_extras_removidos:r?M:void 0,ambas_mitades_extras_agregados:r?E:void 0,ambas_mitades_extras_removidos:r?A:void 0,notas:W.trim()||void 0,pizza:r?void 0:n,extras_agregados_data:r?[]:g.map(a=>d.find(i=>i.id===a)).filter(a=>!!a),extras_removidos_data:r?[]:h.map(a=>d.find(i=>i.id===a)).filter(a=>!!a),mitad1_extras_agregados_data:r?_.map(a=>d.find(i=>i.id===a)).filter(a=>!!a):void 0,mitad1_extras_removidos_data:r?y.map(a=>d.find(i=>i.id===a)).filter(a=>!!a):void 0,mitad2_extras_agregados_data:r?w.map(a=>d.find(i=>i.id===a)).filter(a=>!!a):void 0,mitad2_extras_removidos_data:r?M.map(a=>d.find(i=>i.id===a)).filter(a=>!!a):void 0,ambas_mitades_extras_agregados_data:r?E.map(a=>d.find(i=>i.id===a)).filter(a=>!!a):void 0,ambas_mitades_extras_removidos_data:r?A.map(a=>d.find(i=>i.id===a)).filter(a=>!!a):void 0};K(t),F()},I=s=>{switch(o){case"entera":L(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break;case"mitad1":D(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break;case"mitad2":Y(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break;case"ambas":q(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break}},ee=s=>{switch(o){case"entera":T(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break;case"mitad1":U(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break;case"mitad2":G(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break;case"ambas":H(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s]);break}},se=()=>{switch(o){case"entera":return g;case"mitad1":return _;case"mitad2":return w;case"ambas":return E;default:return[]}},te=()=>{switch(o){case"entera":return h;case"mitad1":return y;case"mitad2":return M;case"ambas":return A;default:return[]}};if(!C||!n)return null;const ae=J()*j;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Personalizar Pizza"}),e.jsxs("p",{className:"text-gray-400",children:[n.nombre," - Base: $",Math.round(parseFloat(n.precio_base))]})]}),e.jsx("button",{onClick:F,className:"text-gray-400 hover:text-white text-xl",children:"✕"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-white font-medium",children:"Cantidad:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>k(Math.max(1,j-1)),className:"w-8 h-8 bg-gray-700 hover:bg-gray-600 text-white rounded",children:"-"}),e.jsx("span",{className:"text-white font-bold text-lg w-8 text-center",children:j}),e.jsx("button",{onClick:()=>k(j+1),className:"w-8 h-8 bg-gray-700 hover:bg-gray-600 text-white rounded",children:"+"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"mitad-y-mitad",checked:r,onChange:s=>S(s.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"mitad-y-mitad",className:"text-white font-medium",children:"Pizza Mitad y Mitad"})]}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ml-7",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Mitad 1:"}),e.jsx("select",{value:v,onChange:s=>R(parseInt(s.target.value)),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:m.map(s=>e.jsxs("option",{value:s.id,children:[s.nombre," ($",Math.round(parseFloat(s.precio_base)),")"]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Mitad 2:"}),e.jsx("select",{value:N,onChange:s=>B(parseInt(s.target.value)),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:m.map(s=>e.jsxs("option",{value:s.id,children:[s.nombre," ($",Math.round(parseFloat(s.precio_base)),")"]},s.id))})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"Customización por Sección"}),e.jsx("div",{className:"flex mb-4 bg-gray-700 rounded-lg p-1",children:r?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f("mitad1"),className:`flex-1 px-3 py-2 rounded-md text-xs font-medium transition-colors ${o==="mitad1"?"bg-blue-600 text-white":"text-gray-300 hover:text-white"}`,children:"🟦 Mitad 1"}),e.jsx("button",{onClick:()=>f("mitad2"),className:`flex-1 px-3 py-2 rounded-md text-xs font-medium transition-colors ${o==="mitad2"?"bg-orange-600 text-white":"text-gray-300 hover:text-white"}`,children:"🟧 Mitad 2"}),e.jsx("button",{onClick:()=>f("ambas"),className:`flex-1 px-3 py-2 rounded-md text-xs font-medium transition-colors ${o==="ambas"?"bg-purple-600 text-white":"text-gray-300 hover:text-white"}`,children:"🔮 Ambas Mitades"})]}):e.jsx("button",{onClick:()=>f("entera"),className:`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors ${o==="entera"?"bg-blue-600 text-white":"text-gray-300 hover:text-white"}`,children:"🍕 Personalizar"})}),e.jsxs("div",{className:"mb-3 text-center",children:[o==="entera"&&e.jsxs("span",{className:"text-sm text-gray-400",children:["🍕 ",n.nombre]}),o==="mitad1"&&e.jsxs("span",{className:"text-sm text-gray-400",children:["🟦 ",(X=m.find(s=>s.id===v))==null?void 0:X.nombre]}),o==="mitad2"&&e.jsxs("span",{className:"text-sm text-gray-400",children:["🟧 ",(Z=m.find(s=>s.id===N))==null?void 0:Z.nombre]}),o==="ambas"&&e.jsx("span",{className:"text-sm text-gray-400",children:"🔮 Ambas Mitades"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium text-white mb-3",children:"Ingredientes Incluidos"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:(()=>{let s=[];if(o==="entera")s=n.ingredientes;else if(o==="mitad1"){const t=m.find(a=>a.id===v);s=(t==null?void 0:t.ingredientes)||[]}else if(o==="mitad2"){const t=m.find(a=>a.id===N);s=(t==null?void 0:t.ingredientes)||[]}else if(o==="ambas"){const t=m.find(b=>b.id===v),a=m.find(b=>b.id===N),i=new Set((t==null?void 0:t.ingredientes)||[]),u=new Set((a==null?void 0:a.ingredientes)||[]);s=Array.from(new Set([...i,...u]))}return s.map((t,a)=>{const i=d.find(x=>x.nombre.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(x.nombre.toLowerCase())),u=te(),b=i?u.includes(i.id):!1;return e.jsxs("button",{onClick:()=>{i&&ee(i.id)},className:`p-2 rounded text-sm transition-colors ${b?"bg-red-600 text-white":"bg-gray-600 hover:bg-gray-500 text-gray-300"}`,children:[t," ",b&&"❌"]},`${o}-${a}-${t}`)})})()})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-white mb-3",children:"Extras Disponibles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:d.map(s=>{const a=se().includes(s.id);return e.jsxs("button",{onClick:()=>I(s.id),className:`p-3 rounded-lg text-left transition-all ${a?"bg-green-600 text-white":"bg-gray-600 hover:bg-gray-500 text-gray-300"}`,children:[e.jsx("div",{className:"font-medium",children:s.nombre}),e.jsxs("div",{className:"text-sm font-bold",children:["+$",Math.round(parseFloat(s.precio))]})]},`${o}-extra-${s.id}`)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Notas especiales:"}),e.jsx("textarea",{value:W,onChange:s=>P(s.target.value),placeholder:"Instrucciones especiales para la pizza...",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"💰 Resumen de Precio"}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-gray-300",children:r?"Base (promedio):":"Precio base:"}),e.jsxs("span",{className:"text-white font-bold",children:["$",Math.round(r?(parseFloat(((Q=m.find(s=>s.id===v))==null?void 0:Q.precio_base)||"0")+parseFloat(((O=m.find(s=>s.id===N))==null?void 0:O.precio_base)||"0"))/2:parseFloat((n==null?void 0:n.precio_base)||"0"))]})]}),r?e.jsxs("div",{className:"space-y-2",children:[_.length>0&&e.jsxs("div",{className:"bg-blue-900/20 rounded p-2",children:[e.jsx("div",{className:"text-blue-300 text-sm font-medium mb-1",children:"🟦 Mitad 1 - Extras:"}),_.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-green-300",children:["+ ",t.nombre]}),e.jsxs("span",{className:"text-green-400 font-bold",children:["+$",Math.round(parseFloat(t.precio))]})]},s):null})]}),y.length>0&&e.jsxs("div",{className:"bg-blue-900/20 rounded p-2",children:[e.jsx("div",{className:"text-blue-300 text-sm font-medium mb-1",children:"🟦 Mitad 1 - Sin:"}),y.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-red-300",children:["- ",t.nombre]}),e.jsx("span",{className:"text-red-400 font-bold",children:"-$50"})]},s):null})]}),w.length>0&&e.jsxs("div",{className:"bg-orange-900/20 rounded p-2",children:[e.jsx("div",{className:"text-orange-300 text-sm font-medium mb-1",children:"🟧 Mitad 2 - Extras:"}),w.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-green-300",children:["+ ",t.nombre]}),e.jsxs("span",{className:"text-green-400 font-bold",children:["+$",Math.round(parseFloat(t.precio))]})]},s):null})]}),M.length>0&&e.jsxs("div",{className:"bg-orange-900/20 rounded p-2",children:[e.jsx("div",{className:"text-orange-300 text-sm font-medium mb-1",children:"🟧 Mitad 2 - Sin:"}),M.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-red-300",children:["- ",t.nombre]}),e.jsx("span",{className:"text-red-400 font-bold",children:"-$50"})]},s):null})]}),E.length>0&&e.jsxs("div",{className:"bg-purple-900/20 rounded p-2",children:[e.jsx("div",{className:"text-purple-300 text-sm font-medium mb-1",children:"🔮 Ambas - Extras:"}),E.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-green-300",children:["+ ",t.nombre]}),e.jsxs("span",{className:"text-green-400 font-bold",children:["+$",Math.round(parseFloat(t.precio))]})]},s):null})]}),A.length>0&&e.jsxs("div",{className:"bg-purple-900/20 rounded p-2",children:[e.jsx("div",{className:"text-purple-300 text-sm font-medium mb-1",children:"🔮 Ambas - Sin:"}),A.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-red-300",children:["- ",t.nombre]}),e.jsx("span",{className:"text-red-400 font-bold",children:"-$50"})]},s):null})]})]}):e.jsxs("div",{className:"space-y-2",children:[g.length>0&&e.jsxs("div",{className:"bg-gray-600/30 rounded p-2",children:[e.jsx("div",{className:"text-gray-300 text-sm font-medium mb-1",children:"➕ Extras agregados:"}),g.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-green-300",children:["+ ",t.nombre]}),e.jsxs("span",{className:"text-green-400 font-bold",children:["+$",Math.round(parseFloat(t.precio))]})]},s):null})]}),h.length>0&&e.jsxs("div",{className:"bg-gray-600/30 rounded p-2",children:[e.jsx("div",{className:"text-gray-300 text-sm font-medium mb-1",children:"➖ Ingredientes removidos:"}),h.map(s=>{const t=d.find(a=>a.id===s);return t?e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-red-300",children:["- ",t.nombre]}),e.jsx("span",{className:"text-red-400 font-bold",children:"-$50"})]},s):null})]})]}),e.jsxs("div",{className:"border-t border-gray-600 pt-2 mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-gray-300",children:"Precio unitario:"}),e.jsxs("span",{className:"text-white font-bold",children:["$",Math.round(J())]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-gray-300",children:"Cantidad:"}),e.jsxs("span",{className:"text-white font-bold",children:["x",j]})]}),e.jsx("div",{className:"border-t border-gray-600 pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-white",children:"Total:"}),e.jsxs("span",{className:"text-xl font-bold text-green-400",children:["$",Math.round(ae)]})]})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:F,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors",children:"Cancelar"}),!l&&!r&&g.length===0&&h.length===0&&_.length===0&&y.length===0&&w.length===0&&M.length===0&&E.length===0&&A.length===0&&e.jsx("button",{onClick:()=>{const s={id:`temp_${Date.now()}`,pizza_id:n.id,cantidad:j,precio_unitario:parseFloat(n.precio_base),es_mitad_y_mitad:!1,extras_agregados:[],extras_removidos:[],pizza:n,extras_agregados_data:[],extras_removidos_data:[]};K(s)},className:"flex-1 px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded transition-colors",children:"⚡ Agregar Estándar"}),e.jsxs("button",{onClick:z,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded transition-colors",children:["🎨 ",l?"Actualizar":"Agregar"," Personalizada"]})]})]})]})})}export{de as P};
//# sourceMappingURL=PizzaCustomizationModal-C4AobAN6.js.map
